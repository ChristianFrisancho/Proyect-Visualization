/* ---------- LIGHT ---------- */
:root{
  --bg: #ffffff;
  --text: #0f172a;
  --panel-bg: #ffffff;
  --panel-text: #0f172a;
  --legend-bg: rgba(255,255,255,0.95);
  --tooltip-bg: rgba(15,23,42,0.92);
  --tooltip-text: #ffffff;

  --accent: #2563eb;         /* Renewable */
  --accent-nr: #f59e0b;      /* Non-Renewable */
  --stroke-soft: rgba(2,6,23,0.08);

  /* Mapa */
  --map-water: #ffffff;
  --map-land: #eef2f7;
  --map-stroke: #c9d2de;
  --map-borders: #9aa6b2;
}

/* ---------- DARK ---------- */
:root[data-theme='dark']{
  --bg: #0b0f14;
  --text: #e6eef6;
  --panel-bg: #0f141b;
  --panel-text: #e6eef6;
  --legend-bg: rgba(12,16,22,0.95);
  --tooltip-bg: rgba(230,238,246,0.06);
  --tooltip-text: #e6eef6;

  --accent: #3b82f6;
  --accent-nr: #f59e0b;
  --stroke-soft: rgba(230,238,246,0.10);

  --map-water: var(--panel-bg);
  --map-land: #1a2330;
  --map-stroke: #2e3a4a;
  --map-borders: #3a4960;
}

*{box-sizing:border-box;}
html, body { height: 100%; }
body{
  margin:0; background:var(--bg); color:var(--text);
  font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto;
  transition: background .18s ease, color .18s ease;
}

header{
  display:flex; justify-content:space-between; align-items:center;
  padding:12px 18px; border-bottom:1px solid var(--stroke-soft);
  background:var(--panel-bg);
}
.controls { display:flex; gap:12px; align-items:center; flex-wrap: wrap; }
.controls button{
  background: var(--panel-bg);
  color: var(--panel-text);
  border: 1px solid var(--stroke-soft);
  border-radius: 10px;
  padding: 6px 10px;
  cursor: pointer;
}
.controls button:hover{ filter: brightness(1.05); }
#yearRange { width:200px; }
#yearRange:focus-visible, button:focus-visible { outline: 2px solid var(--accent); outline-offset: 2px; border-radius:8px; }

main#layout { display:flex; gap:12px; padding:12px; height: calc(100vh - 96px); }
#mapPanel, #vizPanel { flex:1; background:var(--panel-bg); border-radius:12px; padding:8px; overflow:hidden; position:relative; }
#bubble-map { width:100%; height:100%; background: var(--map-water); }
#sunburst { width:100%; height:100%; min-height:520px; display:flex; align-items:center; justify-content:center; position:relative; }

.tooltip {
  position:absolute; pointer-events:none; visibility:hidden;
  background:var(--tooltip-bg); color:var(--tooltip-text);
  padding:8px 10px; border-radius:8px; font-size:13px; z-index:9999;
  box-shadow: 0 8px 24px rgba(0,0,0,0.15);
}

/* ---------- Leyenda ---------- */
.legendBox {
  position:absolute; right:12px; top:12px; background: var(--legend-bg);
  padding:10px; border-radius:12px; font-size:13px;
  box-shadow:0 6px 18px rgba(0,0,0,0.08);
  color: var(--panel-text);
  max-width: 320px;
}
.legendHeaderBar{
  display:flex; align-items:center; justify-content:space-between; gap:8px; font-weight:700; margin-bottom:6px;
  cursor:default;
}
.legendControls { display:flex; gap:6px; align-items:center; }
.legendBtnTiny{
  border:1px solid var(--stroke-soft); background:transparent; color:var(--panel-text);
  padding:4px 6px; border-radius:8px; cursor:pointer; font-size:12px;
}
.legendBtnTiny.active{ background: var(--stroke-soft); }
.legendRow{ display:flex; align-items:center; justify-content:space-between; gap:8px; margin-top:6px; }
.swatch{ width:12px; height:12px; border-radius:3px; display:inline-block; }
.legendPct{ opacity:.85; }
.legendBtn{
  margin-top:8px; width:100%;
  border:1px solid var(--stroke-soft); background:transparent; color:var(--panel-text);
  padding:6px 8px; border-radius:8px; cursor:pointer;
}
.legendBtn:hover{ filter:brightness(1.05); }
.legendHint{ margin-top:6px; font-size:12px; opacity:.75; }

/* Colapsar */
.legendBox.collapsed{ padding:8px 10px; }
.legendBox.collapsed .legendBody{ display:none; }

/* Status (abajo a la izquierda) */
#statusbar{
  position: fixed; left:12px; bottom:12px; padding:6px 10px;
  background: var(--legend-bg); color: var(--panel-text);
  border-radius: 8px; font-size: 12px; box-shadow:0 6px 18px rgba(0,0,0,0.08);
}

svg { overflow: visible; }

@media (max-width: 980px){
  main#layout { flex-direction: column; height: auto; }
  #sunburst { min-height: 480px; }
}
